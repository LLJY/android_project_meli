# Project Meli Script
# FREE TO USE FOR ANYONE
# by PDesire

# Mount RW
mount -o remount,rw /system
mount -o remount,rw /data
mount -o remount,rw /cache

echo '1' > /system/meli_stat

# enable PDesireAudio Ultra High Quality Audio
if [ -e /sys/module/snd_soc_wcd9320/parameters/uhqa_mode_pdesireaudio ]
then
 echo 1 > /sys/module/snd_soc_wcd9320/parameters/uhqa_mode_pdesireaudio
fi
if [ -e /sys/module/snd_soc_wcd9330/parameters/uhqa_mode_pdesireaudio ]
then
 echo 1 > /sys/module/snd_soc_wcd9330/parameters/uhqa_mode_pdesireaudio
fi

# enable tweaks for wcd9335
if [ -e /sys/module/snd_soc_wcd9xxx/parameters ]
then
 chmod 666 /sys/module/snd_soc_wcd9xxx/parameters/impedance_detect_en
 echo 1 > /sys/module/snd_soc_wcd9xxx/parameters/impedance_detect_en
 chmod 444 /sys/module/snd_soc_wcd9xxx/parameters/impedance_detect_en
fi
if [ -e  /sys/module/snd_soc_wcd9335 ]
then
 chmod 666 /sys/module/snd_soc_wcd9335/parameters/sido_buck_svs_voltage
 echo 965 > /sys/module/snd_soc_wcd9335/parameters/sido_buck_svs_voltage
 chmod 444 /sys/module/snd_soc_wcd9335/parameters/sido_buck_svs_voltage
fi
# enable Audio High Performance Mode
if [ -e /sys/module/snd_soc_wcd9320/parameters ]
then
 chmod 666 /sys/module/snd_soc_wcd9320/parameters/high_perf_mode
 echo 1 > /sys/module/snd_soc_wcd9320/parameters/high_perf_mode
 chmod 444 /sys/module/snd_soc_wcd9320/parameters/high_perf_mode
fi
if [ -e /sys/module/snd_soc_wcd9330/parameters ]
then
 chmod 666 /sys/module/snd_soc_wcd9330/parameters/high_perf_mode
 echo 1 > /sys/module/snd_soc_wcd9330/parameters/high_perf_mode
 chmod 444 /sys/module/snd_soc_wcd9330/parameters/high_perf_mode
fi

fi
# disable lpa
setprop lpa.decode false
setprop lpa.releaselock false
setprop lpa.use-stagefright false
setprop tunnel.decode false
setprop tunnel.audio.decode false

# increase buffer
setprop audio.offload.buffer.size.kb 1024

# Mount RO again
mount -o remount,ro /system
mount -o remount,ro /cache
